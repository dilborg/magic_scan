<html>
  <head>
<script>
var source = new EventSource('/stream');
source.addEventListener('message', function(e) {
    var data = JSON.parse(e.data);

    var taken_photo = {
      picture: data.scanned_image,
      cards: []
    };

    var matches = [taken_photo].concat(data.matches);
    var images = document.querySelectorAll("#images > li > div > img");
    var titles = document.querySelectorAll("#images > li > div > p");

    for (var i = 0; i < images.length; i++) {
      var possibility = matches[i];
      var img_data = 'data:image/jpeg;base64,' + possibility.picture;
      images[i].setAttribute('src', img_data);
      var text = possibility.cards.map(function(card) {
        return card.name + " " + possibility.distance;
      }).join();
      titles[i].innerHTML = text;
    }
}, false);
</script>
<style>

ul li {
  display: inline;
}

div.image {
  float: left;
  display: inline;
  margin: 10px;
}

div.image p {
  text-align: center;
}

</style>
  </head>
<body>
  <ul id="images">
    <li>
      <div class="image">
        <img/>
        <p></p>
      </div>
    </li>
    <li>
      <div class="image">
        <img/>
        <p></p>
      </div>
    </li>
    <li>
      <div class="image">
        <img/>
        <p></p>
      </div>
    </li>
    <li>
      <div class="image">
        <img/>
        <p></p>
      </div>
    </li>
  </ul>
</body>
</html>
